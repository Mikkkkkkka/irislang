# –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ IRIS VM

## –û–±–∑–æ—Ä

–î–≤–∞ –ø—Ä–æ—Å—Ç—ã—Ö —Ç–µ—Å—Ç–∞, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏—Ö –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ JIT –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∏ Garbage Collector.

---

## üöÄ –¢–µ—Å—Ç 1: JIT –∫–æ–º–ø–∏–ª—è—Ü–∏—è —É—Å–∫–æ—Ä—è–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

**–§–∞–π–ª:** `modules/vm/src/test/kotlin/dev/iris/vm/JitBenchmarkTest.kt`

**–ü—Ä–æ–≥—Ä–∞–º–º–∞:** –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ `fibonacci(10)` –≤ —Ü–∏–∫–ª–µ 500 —Ä–∞–∑

### –†–µ–∑—É–ª—å—Ç–∞—Ç:

```
=== JIT PERFORMANCE COMPARISON ===
Program: Calling fibonacci(10) 500 times

WITHOUT JIT: 97ms (interpreted)
WITH JIT:    10ms (compiled after 10 calls)
Speedup:     9.70x

‚úì JIT compilation provides significant speedup
```

### –í—ã–≤–æ–¥:

- **–ë–ï–ó JIT:** –ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ ‚Üí –º–µ–¥–ª–µ–Ω–Ω–æ (97ms)
- **–° JIT:** –ü–æ—Å–ª–µ 10 –≤—ã–∑–æ–≤–æ–≤ —Ñ—É–Ω–∫—Ü–∏—è –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è ‚Üí –±—ã—Å—Ç—Ä–æ (10ms)
- **–£–°–ö–û–†–ï–ù–ò–ï: 9.7 —Ä–∞–∑!** ‚ö°

---

## üóëÔ∏è –¢–µ—Å—Ç 2: GC –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –ø–∞–º—è—Ç—å

**–§–∞–π–ª:** `modules/vm/src/test/kotlin/dev/iris/vm/GcBenchmarkTest.kt`

**–ü—Ä–æ–≥—Ä–∞–º–º–∞:** –°–æ–∑–¥–∞–Ω–∏–µ 300 –º–∞—Å—Å–∏–≤–æ–≤, –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –º—É—Å–æ—Ä–æ–º

### –†–µ–∑—É–ª—å—Ç–∞—Ç:

```
=== GARBAGE COLLECTION DEMONSTRATION ===
Program: Creates 300 arrays, most become garbage

WITHOUT frequent GC:
  Threshold: 100000 (very high)
  GC runs: ~0 times
  Heap objects: 301 (accumulated)

WITH frequent GC:
  Threshold: 50 (low)
  GC runs: ~6 times
  Heap objects: 2 (cleaned up)

‚úì GC freed 299 objects from heap!
‚úì Memory reduction: 301 ‚Üí 2 objects
```

### –í—ã–≤–æ–¥:

- **–ë–ï–ó —á–∞—Å—Ç–æ–≥–æ GC:** 301 –æ–±—ä–µ–∫—Ç –≤ –ø–∞–º—è—Ç–∏ (–º—É—Å–æ—Ä –Ω–µ —Å–æ–±—Ä–∞–Ω)
- **–° —á–∞—Å—Ç—ã–º GC:** 2 –æ–±—ä–µ–∫—Ç–∞ –≤ –ø–∞–º—è—Ç–∏ (–º—É—Å–æ—Ä —Å–æ–±—Ä–∞–Ω)
- **–û–°–í–û–ë–û–ñ–î–ï–ù–û: 299 –æ–±—ä–µ–∫—Ç–æ–≤ (99.3%)!** üóëÔ∏è

---

## üìä –ò—Ç–æ–≥–∏

### JIT –∫–æ–º–ø–∏–ª—è—Ü–∏—è

‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç –≥–æ—Ä—è—á–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚úÖ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞** - —É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–æ **9.7x**
‚úÖ **–ü—Ä–æ–∑—Ä–∞—á–Ω–∞** - –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–µ–π

### Garbage Collection

‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π** - –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –æ—Å–≤–æ–±–æ–∂–¥–∞—Ç—å –ø–∞–º—è—Ç—å
‚úÖ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π** - –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç **99.3%** –º—É—Å–æ—Ä–∞ (299 –∏–∑ 301 –æ–±—ä–µ–∫—Ç–∞)
‚úÖ **–ù–∞–¥–µ–∂–Ω—ã–π** - –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ –æ–±–æ–∏—Ö —Å–ª—É—á–∞—è—Ö

---

## üî¨ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

```bash
# –û–±–∞ —Ç–µ—Å—Ç–∞
./gradlew :vm:test --tests "*BenchmarkTest"

# –¢–æ–ª—å–∫–æ JIT
./gradlew :vm:test --tests "JitBenchmarkTest"

# –¢–æ–ª—å–∫–æ GC
./gradlew :vm:test --tests "GcBenchmarkTest"
```

---

## ‚ú® –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–¢–µ—Å—Ç—ã –Ω–∞–≥–ª—è–¥–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ:

1. **JIT –∫–æ–º–ø–∏–ª—è—Ü–∏—è** –¥–∞–µ—Ç **—É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ 9.7 —Ä–∞–∑** –¥–ª—è –≥–æ—Ä—è—á–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
2. **Garbage Collector** –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç **99.3% –º—É—Å–æ—Ä–∞** (299 –∏–∑ 301 –æ–±—ä–µ–∫—Ç–∞)

**IRIS VM –≥–æ—Ç–æ–≤–∞ –¥–ª—è —Å–µ—Ä—å–µ–∑–Ω—ã—Ö –∑–∞–¥–∞—á!** üöÄ
